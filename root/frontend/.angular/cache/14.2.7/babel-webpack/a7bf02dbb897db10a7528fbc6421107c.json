{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/api.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../services/auth.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\n\nfunction ReportsComponent_div_0_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"form\", 9, 10);\n    i0.ɵɵlistener(\"ngSubmit\", function ReportsComponent_div_0_div_10_Template_form_ngSubmit_1_listener() {\n      i0.ɵɵrestoreView(_r6);\n\n      const _r4 = i0.ɵɵreference(2);\n\n      const ctx_r5 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r5.onSubmit(_r4));\n    });\n    i0.ɵɵelementStart(3, \"div\", 11)(4, \"label\", 12);\n    i0.ɵɵtext(5, \"Start Date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(6, \"input\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 11)(8, \"label\", 14);\n    i0.ɵɵtext(9, \"End Date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"input\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"div\", 11)(12, \"label\", 16);\n    i0.ɵɵtext(13, \"Employee Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(14, \"input\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"div\", 18)(16, \"button\", 19);\n    i0.ɵɵtext(17, \"Apply\");\n    i0.ɵɵelementEnd()()()();\n  }\n}\n\nfunction ReportsComponent_div_0_div_11_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22)(1, \"div\", 23)(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const report_r8 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Employee Name: \", report_r8.employeeName, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Task performed \", report_r8.changeDescription, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Date: \", report_r8.date, \"\");\n  }\n}\n\nfunction ReportsComponent_div_0_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵtemplate(1, ReportsComponent_div_0_div_11_div_1_Template, 8, 3, \"div\", 21);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.reports);\n  }\n}\n\nfunction ReportsComponent_div_0_div_12_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22)(1, \"div\", 23)(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const report_r10 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Employee Name: \", report_r10.employeeName, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Task performed \", report_r10.changeDescription, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Date: \", report_r10.date, \"\");\n  }\n}\n\nfunction ReportsComponent_div_0_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵtemplate(1, ReportsComponent_div_0_div_12_div_1_Template, 8, 3, \"div\", 21);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.reports);\n  }\n}\n\nfunction ReportsComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"h1\", 2);\n    i0.ɵɵtext(2, \"Reports\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"br\");\n    i0.ɵɵelementStart(4, \"h4\", 3);\n    i0.ɵɵtext(5, \"Employee Changes Log\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\")(7, \"div\", 4)(8, \"button\", 5);\n    i0.ɵɵlistener(\"click\", function ReportsComponent_div_0_Template_button_click_8_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.showFiltersForm());\n    });\n    i0.ɵɵtext(9, \"Filters\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(10, ReportsComponent_div_0_div_10_Template, 18, 0, \"div\", 6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(11, ReportsComponent_div_0_div_11_Template, 2, 1, \"div\", 7);\n    i0.ɵɵtemplate(12, ReportsComponent_div_0_div_12_Template, 2, 1, \"div\", 7);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(10);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.showForm);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.noFilters);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.withFilters);\n  }\n}\n\nexport let ReportsComponent = /*#__PURE__*/(() => {\n  class ReportsComponent {\n    constructor(_api, _router, _auth) {\n      this._api = _api;\n      this._router = _router;\n      this._auth = _auth;\n      this.isLogin = false;\n      this.dateTime = [];\n      this.showForm = false;\n      this.reports = [];\n      this.reportsWithFilters = [];\n      this.noFilters = false;\n      this.withFilters = false;\n    }\n\n    ngOnInit() {\n      this.isUserLogin();\n    }\n\n    isUserLogin() {\n      if (this._auth.getUserDetails() != null) {\n        this.isLogin = true;\n        this.noFilters = true;\n        this.renderReports();\n      } else {\n        this._router.navigate(['login']);\n      }\n    }\n\n    renderReports() {\n      console.log('render reports');\n      this.reports = [];\n\n      this._api.getTypeRequest('reports/get-all-reports').subscribe(res => {\n        console.log(res);\n\n        if (res.status) {\n          for (let i = 0; i < res.data.length; i++) {\n            let employeeId = res.data[i].employeeId;\n            let changeDescription = res.data[i].changeDescription;\n            let date = res.data[i].date;\n\n            if (!this.dateTime.includes(date.toString())) {\n              this.dateTime.push(date.toString());\n\n              this._api.postTypeRequest('tasks/get-employee-name', {\n                employeeId: employeeId\n              }).subscribe(res => {\n                console.log(res);\n\n                if (res.status) {\n                  let employeeName = res.data[0].firstName + ' ' + res.data[0].lastName;\n                  let modifiedDate = date.toString().replace('T', ' ');\n                  let finalDate = modifiedDate.toString().replace('.000Z', ' ');\n                  this.reports.push({\n                    employeeName: employeeName,\n                    changeDescription: changeDescription,\n                    date: finalDate\n                  }); // let html = `\n                  //   <div class=\"card mb-3\">\n                  //     <div class=\"card-body\">\n                  //       <p>Employee Name: ${employeeName}</p>\n                  //       <p>Task performed: ${changeDescription}</p>\n                  //       <p>Date: ${finalDate}</p>\n                  //     </div>\n                  //   </div>`;\n                  // $('#reports').append(html);\n                  // $('.card').css('background-color', '#3b5249');\n                  // $('.card').css('color', 'white');\n                }\n              });\n            }\n          }\n        }\n      });\n    }\n\n    showFiltersForm() {\n      this.showForm = true;\n    }\n\n    onSubmit(form) {\n      this.noFilters = false;\n      this.reportsWithFilters = this.reports;\n      console.log(form.value);\n      let employeeName = form.value.employeeName;\n      let startDate = form.value.startDate;\n      let endDate = form.value.endDate;\n\n      if (startDate.length > 0 && endDate == '' || startDate == '' && endDate.length > 0 && employeeName.length == 0) {\n        alert('Please enter both a start and end date');\n      } else {\n        for (let i = 0; i < this.reportsWithFilters.length; i++) {\n          let date = this.reportsWithFilters[i].date;\n          let formattedDate = date.slice(0, 10);\n          console.log(startDate + ' ' + formattedDate);\n\n          if (formattedDate < startDate || formattedDate > endDate) {\n            this.reportsWithFilters.splice(i, 1);\n          }\n        }\n\n        this.withFilters = true;\n      }\n\n      if (employeeName.length > 0 && startDate.length == 0 && endDate.length == 0) {\n        for (let i = 0; i < this.reportsWithFilters.length; i++) {\n          let employee = this.reportsWithFilters[i].employeeName;\n\n          if (!employee.includes(employeeName)) {\n            this.reportsWithFilters.splice(i, 1);\n          }\n        }\n\n        this.withFilters = true;\n      }\n\n      if (employeeName.length > 0 && startDate.length > 0 && endDate.length > 0) {\n        for (let i = 0; i < this.reportsWithFilters.length; i++) {\n          let employee = this.reportsWithFilters[i].employeeName;\n          let date = this.reportsWithFilters[i].date;\n          let formattedDate = date.slice(0, 10);\n\n          if (!employee.includes(employeeName) && (formattedDate < startDate || formattedDate > endDate)) {\n            this.reportsWithFilters.splice(i, 1);\n          }\n        }\n\n        this.withFilters = true;\n      }\n\n      if (employeeName.length == 0 && startDate.length == 0 && endDate.length == 0) {\n        alert('Please enter a name or a date range');\n        this.noFilters = true;\n        this.withFilters = false;\n      }\n\n      form.reset();\n    }\n\n  }\n\n  ReportsComponent.ɵfac = function ReportsComponent_Factory(t) {\n    return new (t || ReportsComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.AuthService));\n  };\n\n  ReportsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ReportsComponent,\n    selectors: [[\"app-reports\"]],\n    decls: 1,\n    vars: 1,\n    consts: [[\"id\", \"reportsDiv\", 4, \"ngIf\"], [\"id\", \"reportsDiv\"], [1, \"text-center\", \"pt-5\"], [1, \"ps-5\"], [1, \"text-end\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", \"me-5\", 3, \"click\"], [\"id\", \"filters\", 4, \"ngIf\"], [\"id\", \"reports\", \"class\", \"mx-5 my-3\", 4, \"ngIf\"], [\"id\", \"filters\"], [3, \"ngSubmit\"], [\"filtersForm\", \"ngForm\"], [1, \"form-group\"], [\"for\", \"startDate\"], [\"type\", \"date\", \"id\", \"startDate\", \"name\", \"startDate\", \"ngModel\", \"\", 1, \"form-control\", \"mb-2\"], [\"for\", \"endDate\"], [\"type\", \"date\", \"id\", \"endDate\", \"name\", \"endDate\", \"ngModel\", \"\", 1, \"form-control\", \"mb-5\"], [\"for\", \"employeeName\"], [\"type\", \"text\", \"id\", \"employeeName\", \"name\", \"employeeName\", \"ngModel\", \"\", 1, \"form-control\"], [1, \"text-center\"], [\"type\", \"submit\", \"id\", \"filter\", 1, \"btn\", \"btn-primary\", \"mt-3\"], [\"id\", \"reports\", 1, \"mx-5\", \"my-3\"], [\"class\", \"card mb-3\", 4, \"ngFor\", \"ngForOf\"], [1, \"card\", \"mb-3\"], [1, \"card-body\"]],\n    template: function ReportsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, ReportsComponent_div_0_Template, 13, 3, \"div\", 0);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.isLogin);\n      }\n    },\n    dependencies: [i4.NgForOf, i4.NgIf, i5.ɵNgNoValidate, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.NgModel, i5.NgForm],\n    styles: [\"#reportsDiv[_ngcontent-%COMP%]{color:#fff}#reportsDiv[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background-color:#3b5249;color:#fff}#reportsDiv[_ngcontent-%COMP%]   #filters[_ngcontent-%COMP%]{margin-left:50%;margin-right:10%}\"]\n  });\n  return ReportsComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}